<html>

<body>
    <fieldset>
        <legend>Send Message</legend>
        <input type="text" id="txtMessage" />
        <input type="button" value="Send message" onclick="sendMessage();" />
    </fieldset>
    <fieldset>
        <legend>Send Command</legend>
        <select name="cmbCommand">
    <option value="takePicture">Take Picture</option>
    <option value="enableLed">Enable Led</option>
    <option value="disableLed">Disable Led</option>
    <input type="button" value="Send message" onclick="sendCommand();" />
  </select>
    </fieldset>
    <!-- View the Full Documentation. -->
    <!-- Include the PubNub Library -->
    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.2.5.js"></script>
    <!-- Instantiate PubNub -->
    <script type="text/javascript">

var pubnub = null;
var channelName = "IoTChannel"; 


function sendMessage() {
    pubnub.publish(
        {
            channel : channelName,
            message : { 
                command: "displayMessage",
                message: document.getElementById("txtMessage").value 
            }
        }, 
        function(status, response) {
                console.log(status, response);
        }
    );
}

function sendCommand() {
    pubnub.publish(
        {
            channel : channelName,
            message : { 
                command:  document.getElementById("cmbCommand").value
            }
        }, 
        function(status, response) {
                console.log(status, response);
        }
    );
}



function init() {
   
    pubnub = new PubNub({
      publishKey: 'pub-c-aec2c9d2-5afc-4677-993a-27da78960aec',
      subscribeKey: 'sub-c-59ea358c-ace2-11e6-b37b-02ee2ddab7fe',
      logVerbosity: false
    })
       
    // function publishSampleMessage() {
    //     console.log("Since we're publishing on subscribe connectEvent, we're sure we'll receive the following publish.");
    //     var publishConfig = {
    //         channel : "hello_world",
    //         message : "Hello from PubNub Docs!"
    //     }
    //     pubnub.publish(publishConfig, function(status, response) {
    //         console.log(status, response);
    //     })
    // }
       
    pubnub.addListener({
        status: function(statusEvent) {
            console.log(statusEvent.Category);
            if (statusEvent.category === "PNConnectedCategory") {
                console.log('PNConnectedCategory received.');
                //publishSampleMessage();
            }
        },
        message: function(message) {
            console.log("New Message!!", message);
            //console.log("Message received: " + message.message);
        },
        presence: function(presenceEvent) {
            // handle presence
        }
    })      
    console.log("Subscribing..");
    pubnub.subscribe({
        channels: [channelName] 
    });
};

init();

</script>
</body>

</html>